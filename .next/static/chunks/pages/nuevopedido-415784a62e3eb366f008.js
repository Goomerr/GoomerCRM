(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[757],{8445:function(e,n,t){"use strict";t.d(n,{Z:function(){return f}});var r=t(5893),s=(t(7294),t(9008)),o=t(1664),a=t(1163),i=function(){var e=(0,a.useRouter)();return(0,r.jsxs)("aside",{className:"bg-gray-800 sm:w-1/3 xl:w-1/5 sm:min-h-screen sm:block  p-5",children:[(0,r.jsx)("div",{children:(0,r.jsx)("p",{className:"text-white text-2xl font-black",children:"CRM Clientes"})}),(0,r.jsxs)("nav",{className:"mt-5 list-none",children:[(0,r.jsx)("li",{className:"/"===e.pathname?"bg-blue-800 border-b-2 border-gray-200 p-2":"p-2",children:(0,r.jsx)(o.default,{href:"/",children:(0,r.jsx)("a",{className:"text-white block",children:"Clientes"})})}),(0,r.jsx)("li",{className:"/pedidos"===e.pathname?"bg-blue-800 border-b-2 border-gray-200 p-2":"p-2",children:(0,r.jsx)(o.default,{href:"/pedidos",children:(0,r.jsx)("a",{className:"text-white block",children:"Pedidos"})})}),(0,r.jsx)("li",{className:"/productos"===e.pathname?"bg-blue-800 border-b-2 border-gray-200 p-2":"p-2",children:(0,r.jsx)(o.default,{href:"/productos",children:(0,r.jsx)("a",{className:"text-white block",children:"Productos"})})})]}),(0,r.jsx)("div",{className:"sm:mt-10",children:(0,r.jsx)("p",{className:"text-white text-2xl font-black",children:"Gr\xe1ficas"})}),(0,r.jsxs)("nav",{className:"mt-5 list-none",children:[(0,r.jsx)("li",{className:"/mejoresvendedores"===e.pathname?"bg-blue-800 border-b-2 border-gray-200 p-2":"p-2",children:(0,r.jsx)(o.default,{href:"/mejoresvendedores",children:(0,r.jsx)("a",{className:"text-white block",children:"Mejores Vendedores"})})}),(0,r.jsx)("li",{className:"/mejoresclientes"===e.pathname?"bg-blue-800 border-b-2 border-gray-200 p-2":"p-2",children:(0,r.jsx)(o.default,{href:"/mejoresclientes",children:(0,r.jsx)("a",{className:"text-white block",children:"Mejores Clientes"})})})]})]})},c=t(168),l=t(5333),d=t(570);function u(){var e=(0,c.Z)(["\nquery obtenerUsuario {\n    obtenerUsuario {\n      nombre\n      apellido\n    }\n  }  \n"]);return u=function(){return e},e}var m=(0,l.Ps)(u()),p=function(){var e=(0,a.useRouter)(),n=(0,d.a)(m),t=n.data,s=n.loading;n.error;if(s)return"Cragando...";t||e.push("/login");var o=t.obtenerUsuario,i=o.nombre,c=o.apellido;return(0,r.jsxs)("div",{className:"sm:flex sm:justify-between mb-6",children:[(0,r.jsxs)("p",{className:"mr-2 mb-3 sm:mb-0",children:["Hola: ",i," ",c," "]}),(0,r.jsx)("button",{type:"button",className:"bg-blue-800 hover:bg-gray-800 font-bold uppercase text-xs rounded p-3 text-white shadow-md w-full sm:w-auto",onClick:function(){return localStorage.removeItem("token"),void e.push("/login")},children:"Cerrar Sesi\xf3n"})]})},f=function(e){var n=e.children,t=(0,a.useRouter)();return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(s.default,{children:[(0,r.jsx)("title",{children:"Goomer CRM Administracion de Clientes"}),(0,r.jsx)("link",{rel:"stylesheet",href:"https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css",integrity:"sha512-NhSC1YmyruXifcj/KFRWoC561YpHpc5Jtzgvbuzx5VozKpWvQ+4nXhPdFgmx8xqexRcpAglTj9sIBWINXa8x5w==",crossOrigin:"anonymous",referrerPolicy:"no-referrer"}),(0,r.jsx)("link",{href:"https://unpkg.com/tailwindcss@^2/dist/tailwind.min.css",rel:"stylesheet"})]}),"/login"===t.pathname||"/nuevacuenta"===t.pathname?(0,r.jsx)("div",{className:"bg-gray-800 min-h-screen flex flex-col justify-center",children:n}):(0,r.jsx)("div",{className:"bg-gray-200 min-h-screen",children:(0,r.jsxs)("div",{className:"block sm:flex ",children:[(0,r.jsx)(i,{}),(0,r.jsxs)("main",{className:" sm:w-2/3 xl:w-4/5 sm:min-h-screen p-5",children:[(0,r.jsx)(p,{}),(0,r.jsx)("div",{className:"grid",children:n})]})]})})]})}},2956:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return T}});var r=t(5893),s=t(7757),o=t.n(s),a=t(5461),i=t(5861),c=t(7337),l=t(1013),d=t(168),u=t(7294),m=t(8445),p=t(8898),f=t(5333),h=t(570),b=t(5502);function x(){var e=(0,d.Z)(["\n    query obtenerClientesVendedor {\n        obtenerClientesVendedor {\n        id\n        nombre\n        apellido\n        empresa\n        email\n        }\n    }  \n"]);return x=function(){return e},e}var g=(0,f.Ps)(x()),j=function(){var e=(0,u.useState)([]),n=e[0],t=e[1],s=(0,u.useContext)(b.Z).agregarCliente,o=(0,h.a)(g),a=o.data,i=o.loading;o.error;(0,u.useEffect)((function(){s(n)}),[n]);if(i)return null;var c=a.obtenerClientesVendedor;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("p",{className:"mt-10 my-2 bg-white border-l-4 border-gray-700 p-2 text-sm font-bold",children:"1.- Asigna un Cliente al Pedido"}),(0,r.jsx)(p.ZP,{options:c,onChange:function(e){t(e)},getOptionValue:function(e){return e.id},getOptionLabel:function(e){return"".concat(e.nombre," ").concat(e.apellido)},placeholder:"Busque o Seleccione un Cliente",noOptionsMessage:function(){return"No hay resultados"}})]})};function v(){var e=(0,d.Z)(["\nquery obtenerProductos {\n    obtenerProductos {\n      id\n      nombre\n      existencia\n      precio\n    }\n  }\n"]);return v=function(){return e},e}var y=(0,f.Ps)(v()),w=function(){var e=(0,u.useState)([]),n=e[0],t=e[1],s=(0,u.useContext)(b.Z).agregarProducto,o=(0,h.a)(y),a=o.data,i=o.loading;o.error;(0,u.useEffect)((function(){s(n)}),[n]);if(i)return null;var c=a.obtenerProductos;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("p",{className:"mt-4 my-2 bg-white border-l-4 border-gray-700 p-2 text-sm font-bold",children:"2.- Asigna un Producto al Pedido"}),(0,r.jsx)(p.ZP,{isMulti:!0,options:c,onChange:function(e){return function(e){t(e)}(e)},getOptionValue:function(e){return e.id},getOptionLabel:function(e){return"".concat(e.nombre," - ").concat(e.existencia," Disponibles")},placeholder:"Busque o Seleccione un Producto",noOptionsMessage:function(){return"No hay resultados"}})]})},N=t(4942);function P(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function C(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?P(Object(t),!0).forEach((function(n){(0,N.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):P(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var O=function(e){var n=e.producto,t=(0,u.useContext)(b.Z),s=t.cantidadProductos,o=t.actualizarTotal,a=(0,u.useState)(0),i=a[0],c=a[1];(0,u.useEffect)((function(){l(),o()}),[i]);var l=function(){var e=C(C({},n),{},{cantidad:Number(i)});s(e)},d=n.nombre,m=n.precio;return(0,r.jsxs)("div",{className:"md:flex md:justify-between md:items-center mt-5",children:[(0,r.jsxs)("div",{className:"md:w-2/4 mb-2 md:mb-0",children:[(0,r.jsxs)("p",{className:"text-lg",children:[d," "]}),(0,r.jsxs)("p",{className:"font-bold",children:[m," \u20ac"]})]}),(0,r.jsx)("input",{className:" text-center font-bold shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:ring",type:"number",placeholder:"Cantidad",min:"1",value:i,onChange:function(e){return c(e.target.value)}})]})},k=function(){var e=(0,u.useContext)(b.Z).productos;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("p",{className:"mt-4 my-2 bg-white border-l-4 border-gray-700 p-2 text-sm font-bold",children:"3.- Resumen Pedido, Escoge la Cantidad de Cada Producto"}),e.length>0?(0,r.jsx)(r.Fragment,{children:e.map((function(e){return(0,r.jsx)(O,{producto:e},e.id)}))}):(0,r.jsx)("p",{className:"mt-5 text-sm font-bold",children:"A\xfan no hay productos"})]})},Z=function(){var e=(0,u.useContext)(b.Z).total;return(0,r.jsxs)("div",{className:"flex items-center mt-5 justify-between bg-white border-solid border-2 p-3 border-gray-100",children:[(0,r.jsx)("h2",{className:"text-gray-800 text-lg",children:"Total a Pagar: "}),(0,r.jsxs)("p",{className:"font-bold",children:[" ",e," \u20ac"]})]})},_=t(1163),E=t(5709),S=t(6455),V=t.n(S);function q(){var e=(0,d.Z)(["\nquery obtenerPedidosVendedor {\n    obtenerPedidosVendedor {\n      id\n      pedido {\n        id\n        cantidad\n        nombre\n      }\n      total\n      cliente {\n          id\n          nombre\n          apellido\n          telefono\n          email\n      }\n      vendedor\n      estado\n      fecha\n    }\n  } \n"]);return q=function(){return e},e}function R(){var e=(0,d.Z)(["\n    mutation nuevoPedido($input: PedidoInput) {\n        nuevoPedido(input: $input) {\n          id\n        }\n    }\n"]);return R=function(){return e},e}var F=(0,f.Ps)(R()),M=(0,f.Ps)(q()),T=function(){var e=(0,_.useRouter)(),n=(0,u.useState)(null),t=n[0],s=n[1],d=(0,u.useContext)(b.Z),p=d.cliente,f=d.productos,h=d.total,x=p.id,g=(0,E.D)(F,{update:function(e,n){var t=n.data.nuevoPedido,r=e.readQuery({query:M}).obtenerPedidosVendedor;e.writeQuery({query:M,data:{obtenerPedidosVendedor:[].concat((0,c.Z)(r),[t])}})}}),v=(0,l.Z)(g,1)[0],y=function(){var n=(0,i.Z)(o().mark((function n(){var t,r;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=f.map((function(e){e.__typename,e.existencia;return(0,a.Z)(e,["__typename","existencia"])})),n.prev=1,n.next=4,v({variables:{input:{cliente:x,total:h,pedido:t}}});case 4:r=n.sent,r.data,V().fire("Correcto","El Pedido se registro correctamente","success"),setTimeout((function(){e.push("/pedidos")}),1500),n.next=14;break;case 10:n.prev=10,n.t0=n.catch(1),s(n.t0.message),setTimeout((function(){s(null)}),3e3);case 14:case"end":return n.stop()}}),n,null,[[1,10]])})));return function(){return n.apply(this,arguments)}}();return(0,r.jsxs)(m.Z,{children:[(0,r.jsx)("h1",{className:"text-2xl text-gray-800 font-light",children:"Nuevo Pedido"}),t&&(0,r.jsx)("div",{className:"font-bold bg-white py-2 px-3 w-full my-3 max-w-lg rounded text-center mx-auto",children:(0,r.jsxs)("p",{children:[t," "]})}),(0,r.jsx)("div",{className:"flex justify-center mt-5",children:(0,r.jsxs)("div",{className:"w-full max-w-lg",children:[(0,r.jsx)(j,{}),(0,r.jsx)(w,{}),(0,r.jsx)(k,{}),(0,r.jsx)(Z,{}),(0,r.jsx)("button",{type:"button",className:" bg-gray-800 hover:bg-gray-900 w-full mt-5 p-2 text-white uppercase font-bold ".concat(f.every((function(e){return e.cantidad>0}))&&0!==h&&0!==p.length?"":" opacity-50 cursor-not-allowed "),onClick:function(){return y()},children:"Guardar Pedido "}),(0,r.jsx)("button",{onClick:function(){return e.push("/pedidos")},type:"button",className:"bg-gray-800 hover:bg-gray-900 w-full mt-5 p-2 text-white uppercase font-bold ",children:" cancelar "})]})})]})}},251:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/nuevopedido",function(){return t(2956)}])}},function(e){e.O(0,[774,26,455,703,888,179],(function(){return n=251,e(e.s=n);var n}));var n=e.O();_N_E=n}]);