(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[499],{5709:function(e,t,n){"use strict";n.d(t,{D:function(){return h}});var r=n(3564),o=n(7294),i=n(2152),s=n(4901),a=n(1498),l=n(7164),d=n(9560),c=function(e){function t(t){var n=t.options,r=t.context,o=t.result,i=t.setResult,a=e.call(this,n,r)||this;return a.runMutation=function(e){void 0===e&&(e={}),a.onMutationStart();var t=a.generateNewMutationId();return a.mutate(e).then((function(e){return a.onMutationCompleted(e,t),e})).catch((function(e){var n=a.getOptions().onError;if(a.onMutationError(e,t),n)return n(e),{data:void 0,errors:e};throw e}))},a.verifyDocumentType(n.mutation,s.n_.Mutation),a.result=o,a.setResult=i,a.mostRecentMutationId=0,a}return(0,r.ZT)(t,e),t.prototype.execute=function(e){return this.isMounted=!0,this.verifyDocumentType(this.getOptions().mutation,s.n_.Mutation),[this.runMutation,(0,r.pi)((0,r.pi)({},e),{client:this.refreshClient().client})]},t.prototype.afterExecute=function(){return this.isMounted=!0,this.unmount.bind(this)},t.prototype.cleanup=function(){},t.prototype.mutate=function(e){return this.refreshClient().client.mutate((0,d.J)(this.getOptions(),e))},t.prototype.onMutationStart=function(){this.result.loading||this.getOptions().ignoreResults||this.updateResult({loading:!0,error:void 0,data:void 0,called:!0})},t.prototype.onMutationCompleted=function(e,t){var n=this.getOptions(),r=n.onCompleted,o=n.ignoreResults,i=e.data,s=e.errors,l=s&&s.length>0?new a.c({graphQLErrors:s}):void 0;this.isMostRecentMutation(t)&&!o&&this.updateResult({called:!0,loading:!1,data:i,error:l}),r&&r(i)},t.prototype.onMutationError=function(e,t){this.isMostRecentMutation(t)&&this.updateResult({loading:!1,error:e,data:void 0,called:!0})},t.prototype.generateNewMutationId=function(){return++this.mostRecentMutationId},t.prototype.isMostRecentMutation=function(e){return this.mostRecentMutationId===e},t.prototype.updateResult=function(e){if(this.isMounted&&(!this.previousResult||!(0,i.D)(this.previousResult,e)))return this.setResult(e),this.previousResult=e,e},t}(l.V),u=n(4273);function h(e,t){var n=(0,o.useContext)((0,u.K)()),i=(0,o.useState)({called:!1,loading:!1}),s=i[0],a=i[1],l=t?(0,r.pi)((0,r.pi)({},t),{mutation:e}):{mutation:e},d=(0,o.useRef)();var h=(d.current||(d.current=new c({options:l,context:n,result:s,setResult:a})),d.current);return h.setOptions(l),h.context=n,(0,o.useEffect)((function(){return h.afterExecute()})),h.execute(s)}},8445:function(e,t,n){"use strict";n.d(t,{Z:function(){return f}});var r=n(5893),o=(n(7294),n(9008)),i=n(1664),s=n(1163),a=function(){var e=(0,s.useRouter)();return(0,r.jsxs)("aside",{className:"bg-gray-800 sm:w-1/3 xl:w-1/5 sm:min-h-screen sm:block  p-5",children:[(0,r.jsx)("div",{children:(0,r.jsx)("p",{className:"text-white text-2xl font-black",children:"CRM Clientes"})}),(0,r.jsxs)("nav",{className:"mt-5 list-none",children:[(0,r.jsx)("li",{className:"/"===e.pathname?"bg-blue-800 border-b-2 border-gray-200 p-2":"p-2",children:(0,r.jsx)(i.default,{href:"/",children:(0,r.jsx)("a",{className:"text-white block",children:"Clientes"})})}),(0,r.jsx)("li",{className:"/pedidos"===e.pathname?"bg-blue-800 border-b-2 border-gray-200 p-2":"p-2",children:(0,r.jsx)(i.default,{href:"/pedidos",children:(0,r.jsx)("a",{className:"text-white block",children:"Pedidos"})})}),(0,r.jsx)("li",{className:"/productos"===e.pathname?"bg-blue-800 border-b-2 border-gray-200 p-2":"p-2",children:(0,r.jsx)(i.default,{href:"/productos",children:(0,r.jsx)("a",{className:"text-white block",children:"Productos"})})})]}),(0,r.jsx)("div",{className:"sm:mt-10",children:(0,r.jsx)("p",{className:"text-white text-2xl font-black",children:"Gr\xe1ficas"})}),(0,r.jsxs)("nav",{className:"mt-5 list-none",children:[(0,r.jsx)("li",{className:"/mejoresvendedores"===e.pathname?"bg-blue-800 border-b-2 border-gray-200 p-2":"p-2",children:(0,r.jsx)(i.default,{href:"/mejoresvendedores",children:(0,r.jsx)("a",{className:"text-white block",children:"Mejores Vendedores"})})}),(0,r.jsx)("li",{className:"/mejoresclientes"===e.pathname?"bg-blue-800 border-b-2 border-gray-200 p-2":"p-2",children:(0,r.jsx)(i.default,{href:"/mejoresclientes",children:(0,r.jsx)("a",{className:"text-white block",children:"Mejores Clientes"})})})]})]})},l=n(168),d=n(5333),c=n(570);function u(){var e=(0,l.Z)(["\nquery obtenerUsuario {\n    obtenerUsuario {\n      nombre\n      apellido\n    }\n  }  \n"]);return u=function(){return e},e}var h=(0,d.Ps)(u()),m=function(){var e=(0,s.useRouter)(),t=(0,c.a)(h),n=t.data,o=t.loading;t.error;if(o)return"Cragando...";n||e.push("/login");var i=n.obtenerUsuario,a=i.nombre,l=i.apellido;return(0,r.jsxs)("div",{className:"sm:flex sm:justify-between mb-6",children:[(0,r.jsxs)("p",{className:"mr-2 mb-3 sm:mb-0",children:["Hola: ",a," ",l," "]}),(0,r.jsx)("button",{type:"button",className:"bg-blue-800 hover:bg-gray-800 font-bold uppercase text-xs rounded p-3 text-white shadow-md w-full sm:w-auto",onClick:function(){return localStorage.removeItem("token"),void e.push("/login")},children:"Cerrar Sesi\xf3n"})]})},f=function(e){var t=e.children,n=(0,s.useRouter)();return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(o.default,{children:[(0,r.jsx)("title",{children:"Goomer CRM Administracion de Clientes"}),(0,r.jsx)("link",{rel:"stylesheet",href:"https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css",integrity:"sha512-NhSC1YmyruXifcj/KFRWoC561YpHpc5Jtzgvbuzx5VozKpWvQ+4nXhPdFgmx8xqexRcpAglTj9sIBWINXa8x5w==",crossOrigin:"anonymous",referrerPolicy:"no-referrer"}),(0,r.jsx)("link",{href:"https://unpkg.com/tailwindcss@^2/dist/tailwind.min.css",rel:"stylesheet"})]}),"/login"===n.pathname||"/nuevacuenta"===n.pathname?(0,r.jsx)("div",{className:"bg-gray-800 min-h-screen flex flex-col justify-center",children:t}):(0,r.jsx)("div",{className:"bg-gray-200 min-h-screen",children:(0,r.jsxs)("div",{className:"block sm:flex ",children:[(0,r.jsx)(a,{}),(0,r.jsxs)("main",{className:" sm:w-2/3 xl:w-4/5 sm:min-h-screen p-5",children:[(0,r.jsx)(m,{}),(0,r.jsx)("div",{className:"grid",children:t})]})]})})]})}},517:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return k}});var r=n(5893),o=n(168),i=n(7294),s=n(8445),a=n(1664),l=n(5333),d=n(570),c=n(7757),u=n.n(c),h=n(5861),m=n(1013),f=n(5709),p=n(6455),x=n.n(p);function b(){var e=(0,o.Z)(["\nquery obtenerPedidosVendedor {\n    obtenerPedidosVendedor {\n      id\n  } \n}\n"]);return b=function(){return e},e}function v(){var e=(0,o.Z)(["\nmutation eliminarPedido($id: ID!) {\n    eliminarPedido(id: $id)\n  }\n"]);return v=function(){return e},e}function g(){var e=(0,o.Z)(["\nmutation actualizarPedido($id: ID!, $input: PedidoInput) {\n    actualizarPedido(id: $id, input: $input) {\n      estado\n    }\n  } \n"]);return g=function(){return e},e}var j=(0,l.Ps)(g()),y=(0,l.Ps)(v()),w=(0,l.Ps)(b()),N=function(e){var t=e.pedido,n=t.cliente,o=n.nombre,s=n.apellido,a=n.email,l=n.telefono,d=t.total,c=t.id,p=t.estado,b=t.cliente,v=(0,f.D)(j),g=(0,m.Z)(v,1)[0],N=(0,f.D)(y,{update:function(e){var t=e.readQuery({query:w}).obtenerPedidosVendedor;e.writeQuery({query:w,data:{obtenerPedidosVendedor:t.filter((function(e){return e.id!==c}))}})}}),C=(0,m.Z)(N,1)[0],P=(0,i.useState)(p),k=P[0],M=P[1],E=(0,i.useState)(""),R=E[0],O=E[1];(0,i.useEffect)((function(){k&&M(k),Z()}),[k]);var Z=function(){O("PENDIENTE"===k?"border-yellow-500 order-first":"COMPLETADO"===k?"border-green-500 order-last":"border-red-700 order-last")},D=function(){var e=(0,h.Z)(u().mark((function e(t){var n,r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g({variables:{id:c,input:{estado:t,cliente:b.id}}});case 3:n=e.sent,r=n.data,M(r.actualizarPedido.estado),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}();return(0,r.jsxs)("div",{className:"".concat(R," border-t-4 mt-4 bg-white rounded p-6 md:grid md:grid-cols-2 md:gap-4 shadow-lg"),children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{className:"font-bold text-gray-800",children:["Cliente: ",(0,r.jsxs)("span",{className:"font-semibold",children:[" ",o," ",s]})]}),a&&(0,r.jsxs)("p",{className:"flex items-center my-2",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1",d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),(0,r.jsx)("span",{className:"font-semibold",children:a})]}),l&&(0,r.jsxs)("p",{className:"flex items-center my-2",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),(0,r.jsx)("span",{className:"font-semibold",children:l})]}),(0,r.jsx)("h2",{className:"text-gray-800 font-bold mt-7",children:"Estado Pedido"}),(0,r.jsxs)("select",{className:"mx-2 mt-7  appearance-none bg-blue-600 text-white p-2 text-center rounded leading-tight focus:outline-none focus:ring focus:bg-blue-500 focus:border-blue-500 uppercase text-xs font-bold",value:k,onChange:function(e){return D(e.target.value)},children:[(0,r.jsx)("option",{value:"COMPLETADO",children:"COMPLETADO"}),(0,r.jsx)("option",{value:"PENDIENTE",children:"PENDIENTE"}),(0,r.jsx)("option",{value:"CANCELADO",children:"CANCELADO"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-gray-800 font-bold mt-2",children:"Resumen Pedido"}),t.pedido.map((function(e){return(0,r.jsxs)("div",{className:"mt-4",children:[(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["Producto: ",e.nombre]}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["Cantidad: ",e.cantidad," "]})]},e.id)})),(0,r.jsxs)("p",{className:"text-gray-800 mt-3 font-bold",children:["Total a Pagar:",(0,r.jsxs)("span",{className:"font-semibold",children:[" ",d," \u20ac"]})]}),(0,r.jsxs)("button",{onClick:function(){x().fire({title:"Deseas eliminar este pedido?",text:"Esta acci\xf3n no se puede deshacer!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si, Eliminar!",cancelButtonText:"No, Cancelar"}).then(function(){var e=(0,h.Z)(u().mark((function e(t){var n,r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isConfirmed){e.next=12;break}return e.prev=1,e.next=4,C({variables:{id:c}});case 4:n=e.sent,r=n.data,x().fire("Eliminado!",r.eliminarPedido,"success"),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}())},className:"flex items-center mt-4 bg-red-700 hover:bg-red-900 px-5 py-2 inline-block text-white rounded leading-tight uppercase text-xs font-bold",children:["Eliminar Pedido",(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 ml-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})})]})]})]})};function C(){var e=(0,o.Z)(["\nquery obtenerPedidosVendedor {\n    obtenerPedidosVendedor {\n      id\n      pedido {\n        id\n        cantidad\n        nombre\n      }\n      total\n      cliente {\n          id\n          nombre\n          apellido\n          telefono\n          email\n      }\n      vendedor\n      estado\n      fecha\n    }\n  } \n"]);return C=function(){return e},e}var P=(0,l.Ps)(C()),k=function(){var e=(0,d.a)(P),t=e.data,n=e.loading;e.error;if(n)return"Cargando...";var o=t.obtenerPedidosVendedor;return(0,r.jsx)("div",{children:(0,r.jsxs)(s.Z,{children:[(0,r.jsxs)("div",{className:"order-first",children:[(0,r.jsx)("h1",{className:"text-2xl text-gray-800 font-light",children:"Pedidos"}),(0,r.jsx)(a.default,{href:"/nuevopedido",children:(0,r.jsx)("a",{className:"text-center bg-blue-800 py-2 px-5 mt-5 inline-block text-white uppercase font-bold rounded text-sm hover:bg-gray-800 mb-3 w-full md:w-auto",children:"Nuevo Pedido"})})]}),0===o.length?(0,r.jsx)("p",{className:"mt-5 text-center text-lg",children:"A\xfan no hay pedidos"}):o.map((function(e){return(0,r.jsx)(N,{pedido:e},e.id)}))]})})}},5224:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/pedidos",function(){return n(517)}])},907:function(e,t,n){"use strict";function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n.d(t,{Z:function(){return r}})},5861:function(e,t,n){"use strict";function r(e,t,n,r,o,i,s){try{var a=e[i](s),l=a.value}catch(d){return void n(d)}a.done?t(l):Promise.resolve(l).then(r,o)}function o(e){return function(){var t=this,n=arguments;return new Promise((function(o,i){var s=e.apply(t,n);function a(e){r(s,o,i,a,l,"next",e)}function l(e){r(s,o,i,a,l,"throw",e)}a(void 0)}))}}n.d(t,{Z:function(){return o}})},1013:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(181);function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var s,a=e[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==a.return||a.return()}finally{if(o)throw i}}return n}}(e,t)||(0,r.Z)(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},181:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(907);function o(e,t){if(e){if("string"===typeof e)return(0,r.Z)(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?(0,r.Z)(e,t):void 0}}}},function(e){e.O(0,[26,455,774,888,179],(function(){return t=5224,e(e.s=t);var t}));var t=e.O();_N_E=t}]);